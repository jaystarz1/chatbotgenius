<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NATO M&S Workflow - Interactive Visualization</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'nato-blue': '#003f5c',
                        'nato-light': '#7fb3d3'
                    }
                }
            }
        }
    </script>
    <style>
        .scroll-mt-6 {
            scroll-margin-top: 1.5rem;
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="nato-root"></div>
    
    <script type="text/babel">
        // Check authentication
        if (sessionStorage.getItem('nato_authenticated') !== 'true') {
            window.location.href = 'index.html';
        }

        const { useState, useRef, useEffect } = React;
        
        // Icon components (simplified versions of Lucide React)
        const ChevronDown = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
            </svg>
        );
        
        const ChevronUp = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" />
            </svg>
        );
        
        const ArrowRight = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
            </svg>
        );
        
        const FileText = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
        );
        
        const Settings = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        );

        const FileCheck = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const Bot = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="10" rx="2" ry="2"/>
                <circle cx="12" cy="5" r="2"/>
                <path d="M12 7v4"/>
                <line x1="8" y1="16" x2="8" y2="16"/>
                <line x1="16" y1="16" x2="16" y2="16"/>
            </svg>
        );

        const Terminal = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                <line x1="8" y1="21" x2="16" y2="21"/>
                <line x1="12" y1="17" x2="12" y2="21"/>
            </svg>
        );

        const Activity = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
            </svg>
        );

        const AlertTriangle = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                <line x1="12" y1="9" x2="12" y2="13"/>
                <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
        );

        const Zap = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"/>
            </svg>
        );

        const Cpu = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
                <rect x="9" y="9" width="6" height="6"/>
                <line x1="9" y1="1" x2="9" y2="4"/>
                <line x1="15" y1="1" x2="15" y2="4"/>
                <line x1="9" y1="20" x2="9" y2="23"/>
                <line x1="20" y1="9" x2="23" y2="9"/>
                <line x1="20" y1="14" x2="23" y2="14"/>
                <line x1="1" y1="9" x2="4" y2="9"/>
                <line x1="1" y1="14" x2="4" y2="14"/>
            </svg>
        );

        const FolderOpen = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
            </svg>
        );

        const FileJson = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2Z"/>
                <polyline points="14,2 14,8 20,8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10,9 9,9 8,9"/>
            </svg>
        );

        const BarChart3 = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="12" y1="20" x2="12" y2="10"/>
                <line x1="18" y1="20" x2="18" y2="4"/>
                <line x1="6" y1="20" x2="6" y2="16"/>
            </svg>
        );

        const Database = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <ellipse cx="12" cy="5" rx="9" ry="3"/>
                <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
                <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
            </svg>
        );

        const Hash = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="4" y1="9" x2="20" y2="9"/>
                <line x1="4" y1="15" x2="20" y2="15"/>
                <line x1="10" y1="3" x2="8" y2="21"/>
                <line x1="16" y1="3" x2="14" y2="21"/>
            </svg>
        );

        const RefreshCw = ({ className = "w-4 h-4" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polyline points="23,4 23,10 17,10"/>
                <polyline points="1,20 1,14 7,14"/>
                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
            </svg>
        );

        // Main InteractiveWorkflow Component (converted from your React app)
        const InteractiveWorkflow = () => {
            const [expandedPhase, setExpandedPhase] = useState(null);
            const [hoveredProcess, setHoveredProcess] = useState(null);
            const phaseRefs = useRef({});

            // Reusable DetailBlock component
            const DetailBlock = ({ title, icon, children, color = "border-gray-200" }) => (
                <div className={`bg-white border ${color} rounded-lg p-4 mb-4`}>
                    <h4 className="font-semibold flex items-center gap-2 mb-3 text-gray-800">
                        {icon} {title}
                    </h4>
                    {children}
                </div>
            );

            // Explainer component for technical sections
            const ExplainerBox = ({ title, children, colorClass = "bg-blue-100 border-blue-300 text-blue-900" }) => (
                <div className={`p-3 ${colorClass} rounded-lg border mb-4`}>
                    <p className="text-sm leading-relaxed">
                        <strong>What this means:</strong> {children}
                    </p>
                </div>
            );

            // All the data from your React app
            const phases = [
                {
                    id: 0,
                    name: "Scenario Handoff (NATO Input Reception)",
                    cli: "scenario_handoff",
                    primaryInput: {
                        file: "nato_input.{any}",
                        description: "Raw scenario file from HQ SACT (provided 1 October 2025) - any format"
                    },
                    primaryOutput: {
                        file: "nato_scenario.json",
                        description: "Raw scenario passed through for Phase 1 processing"
                    },
                    color: "bg-gray-400",
                    description: "Simple handoff point - receive NATO scenario and pass to Phase 1",
                    phaseExplanation: "This is simply the moment when NATO hands over the scenario file. No processing occurs here - just receiving the input and making it available to Phase 1. All validation, parsing, and analysis happens in Phase 1 per Annex C requirements.",
                    subProcesses: [
                        { 
                            name: "Receive File", 
                            type: "process",
                            description: "Accept scenario file from HQ SACT in any format (PDF, Word, JSON, etc.)",
                            transforms: "NATO input → Raw file available for processing",
                            explanation: "Simply receives whatever format NATO provides - could be a PDF document, Word file, structured JSON, or any other format. No validation or processing occurs."
                        },
                        { 
                            name: "Stage for Processing", 
                            type: "process",
                            description: "Make file available to Phase 1 without modification",
                            transforms: "Raw file → Staged input for Phase 1",
                            explanation: "Places the raw NATO input in a location where Phase 1 can access it. No changes to content, format, or structure - just staging for the actual M&S lifecycle to begin."
                        }
                    ],
                    dataFlow: {
                        input: "Any format scenario from NATO",
                        internal: "File receipt → Staging for Phase 1",
                        output: "Raw scenario ready for Annex C Phase 1 processing"
                    }
                },
                {
                    id: 1,
                    name: "Problem Definition & Requirements Analysis",
                    cli: "p1_requirements",
                    primaryInput: {
                        file: "nato_scenario.json",
                        description: "Raw NATO scenario from Phase 0 handoff"
                    },
                    primaryOutput: {
                        file: "requirements.json",
                        description: "Complete problem definition with objectives, constraints, stakeholders, and NATO performance measures (KPI/MoE/MoP)"
                    },
                    color: "bg-green-500",
                    description: "AI automation of Annex C Phase 1: complete problem definition including file processing, objectives identification, and performance measures",
                    phaseExplanation: "This phase implements the complete NATO Annex C Phase 1 through AI automation. It starts by processing the raw NATO input (validation, parsing, format conversion), then extracts simulation objectives, defines key requirements and constraints, identifies stakeholders, and establishes NATO-standard performance measures (KPIs, MoEs, MoPs). This demonstrates AI's capability to handle the full problem definition process from raw input to structured requirements.",
                    subProcesses: [
                        { 
                            name: "File Validation & Format Processing", 
                            type: "process",
                            description: "Check file integrity, detect format (PDF/Word/JSON), convert to processable text",
                            transforms: "Raw NATO file → Validated, parsed text content",
                            explanation: "Validates the NATO input file, handles any format (PDF, Word, JSON, etc.), and extracts the textual content for analysis. This is the first step in problem definition - you can't analyze requirements without first accessing the content."
                        },
                        { 
                            name: "Document Structure Analysis", 
                            type: "process",
                            description: "Parse document structure, identify sections (situation, mission, execution, etc.)",
                            transforms: "Text content → Structured document sections",
                            explanation: "Analyzes the document structure to identify key sections like situation description, mission statement, execution details, etc. This helps the AI understand the context and organization of the scenario information."
                        },
                        { 
                            name: "Objectives Identification (Task 1.1)", 
                            type: "process",
                            description: "NLP extraction of simulation objectives from mission statements and commander's intent",
                            transforms: "Document sections → Structured objectives list",
                            explanation: "Uses natural language processing to identify and extract the specific objectives that the simulation needs to address, directly implementing Annex C Task 1.1."
                        },
                        { 
                            name: "Requirements & Constraints Analysis (Task 1.2)", 
                            type: "process",
                            description: "Extract key requirements, operational constraints, stakeholder roles, and environmental factors",
                            transforms: "Document content → Requirements matrix with constraints",
                            explanation: "Identifies all the requirements, limitations, and constraints that will shape the simulation, plus stakeholder roles and responsibilities. This implements Annex C Task 1.2."
                        },
                        { 
                            name: "Performance Measures Establishment (Task 1.3)", 
                            type: "process",
                            description: "Extract and classify KPIs (operational metrics), MoEs (mission effectiveness), MoPs (system performance)",
                            transforms: "Requirements → Categorized NATO performance measures",
                            explanation: "Identifies and properly categorizes all performance measures according to NATO standards: KPIs for operational tracking, MoEs for mission effectiveness assessment, and MoPs for system performance evaluation. This implements Annex C Task 1.3."
                        },
                        { 
                            name: "Entity & Stakeholder Mapping", 
                            type: "process",
                            description: "Map identified entities to NATO ontology IDs and establish stakeholder relationships",
                            transforms: "Raw entities → Standardized NATO IDs with relationships",
                            explanation: "Converts informal references into standardized military terminology and establishes clear stakeholder relationships that will inform the simulation design."
                        },
                        { 
                            name: "Requirements Integration & Validation", 
                            type: "decision",
                            description: "Validate completeness of problem definition, check for contradictions, assess confidence",
                            transforms: "All analysis components → Validated requirements package",
                            explanation: "Ensures all Annex C Phase 1 tasks are complete, checks for internal consistency, and provides confidence assessment for the overall problem definition."
                        }
                    ],
                    dataFlow: {
                        input: "Raw NATO scenario file (any format)",
                        internal: "File processing → Document analysis → Objectives extraction → Requirements analysis → Performance measures → Entity mapping → Integration validation",
                        output: "Complete problem definition with all Annex C Phase 1 deliverables"
                    },
                    performanceCatalog: {
                        data: [
                            { id: "KPI-01", type: "KPI", name: "TimeToSecure", unit: "minutes", threshold: 60, description: "Time to secure primary objective" },
                            { id: "KPI-02", type: "KPI", name: "ResourceConsumption", unit: "percentage", threshold: 80, description: "Logistics resource utilization" },
                            { id: "MoE-01", type: "MoE", name: "MissionSuccess", unit: "boolean", threshold: true, description: "Overall mission completion effectiveness" },
                            { id: "MoE-02", type: "MoE", name: "CasualtyRate", unit: "percentage", threshold: 5, description: "Blue force attrition effectiveness measure" },
                            { id: "MoE-03", type: "MoE", name: "TerrainControl", unit: "percentage", threshold: 75, description: "Percentage of key terrain under friendly control" },
                            { id: "MoP-01", type: "MoP", name: "SystemReliability", unit: "percentage", threshold: 95, description: "Equipment and system operational readiness" },
                            { id: "MoP-02", type: "MoP", name: "CommunicationLatency", unit: "seconds", threshold: 3, description: "Average command and control response time" },
                            { id: "MoP-03", type: "MoP", name: "CivilianImpact", unit: "count", threshold: 0, description: "Unintended civilian casualties (performance measure)" }
                        ],
                        explainer: "These are the specific ways NATO measures success in military operations. The AI automatically identifies and categorizes these from scenario documents into three types:",
                        typeExplainers: {
                            KPI: "Operational metrics you track during the mission (like time, resources used)",
                            MoE: "How well the mission achieved its goals (like mission success rate, casualty rates)", 
                            MoP: "How well systems and equipment performed (like equipment reliability, communication speed)"
                        }
                    }
                }
                // ... Add all other phases here
            ];

            const globalFeatures = [
                {
                    name: "NATO Annex C Implementation",
                    description: "Direct implementation of all seven NATO M&S lifecycle phases per RFP Annex C requirements. Each phase fully automates specific NATO tasks (1.1-1.3, 2.1-2.3, etc.) to test AI capabilities against real military standards."
                },
                {
                    name: "Full Automation Design Philosophy",
                    description: "Zero human intervention design to systematically determine what AI can and cannot do. When AI fails, we capture exactly where and why - providing NATO empirical data on automation boundaries rather than theoretical assumptions."
                },
                {
                    name: "RFP-Compliant Architecture",
                    description: "Modular pipeline designed for HQ SACT scenario input (1 October 2025) with deterministic failure analysis. Each AI module's success/failure provides measurable data for NATO's automation limits assessment."
                },
                {
                    name: "Empirical AI Boundary Testing",
                    description: "Contract-based module integration with comprehensive logging. Every AI call is monitored and analyzed to provide NATO with concrete evidence of where human expertise remains essential vs. where AI can operate autonomously."
                }
            ];

            const FileIcon = ({ type }) => {
                if (type === 'directory') return <FolderOpen className="w-4 h-4" />;
                return <FileJson className="w-4 h-4" />;
            };

            const getProcessIcon = (type) => {
                switch (type) {
                    case 'decision': return <AlertTriangle className="w-4 h-4" />;
                    case 'process': return <Activity className="w-4 h-4" />;
                    default: return <Cpu className="w-4 h-4" />;
                }
            };

            const getProcessColor = (type) => {
                switch (type) {
                    case 'decision': return 'border-yellow-400 bg-yellow-50';
                    case 'process': return 'border-blue-400 bg-blue-50';
                    default: return 'border-gray-400 bg-gray-50';
                }
            };

            const handlePhaseClick = (phaseId) => {
                setExpandedPhase(expandedPhase === phaseId ? null : phaseId);
            };

            useEffect(() => {
                if (expandedPhase !== null && phaseRefs.current[expandedPhase]) {
                    phaseRefs.current[expandedPhase].scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, [expandedPhase]);

            return (
                <div className="max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen">
                    <div className="mb-8 text-center">
                        <h1 className="text-3xl font-bold text-gray-800 mb-2">
                            RFP-ACT-SACT-25-64: AI Support to NATO M&S Lifecycle
                        </h1>
                        <p className="text-gray-600">
                            Full automation design implementing NATO Annex C requirements to systematically determine AI capabilities and limits
                        </p>
                        <div className="mt-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 max-w-5xl mx-auto">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="text-left">
                                    <p className="text-sm text-blue-800 leading-relaxed mb-2">
                                        <strong>RFP Context:</strong> NATO problem domain and statement will be provided <strong>1 October 2025</strong> per RFP Phase 2 requirements.
                                    </p>
                                    <p className="text-sm text-blue-800 leading-relaxed">
                                        <strong>Full Automation Design:</strong> Each phase implements complete AI automation with zero human intervention to systematically test where AI succeeds vs. where human expertise becomes essential.
                                    </p>
                                </div>
                                <div className="text-left">
                                    <p className="text-sm text-indigo-800 leading-relaxed mb-2">
                                        <strong>Annex C Compliance:</strong> Phases 1-7 directly implement NATO's M&S lifecycle tasks. Phase 0 enables automated processing of HQ SACT scenario inputs.
                                    </p>
                                    <p className="text-sm text-indigo-800 leading-relaxed">
                                        <strong>AI Failure Analysis:</strong> When automation fails, we capture exactly where and why - providing NATO empirical data on AI boundaries rather than theoretical assumptions.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <p className="text-sm text-gray-500 mt-4">Click any phase to expand Annex C compliance and AI automation details</p>
                    </div>

                    {/* Global Features */}
                    <div className="mb-8 bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg p-6 border border-gray-200">
                        <h3 className="text-lg font-semibold mb-4 flex items-center gap-2">
                            <Settings className="w-5 h-5" />
                            AI Automation Architecture Principles
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {globalFeatures.map((feature, index) => (
                                <div key={index} className="bg-white p-4 rounded border border-gray-200">
                                    <h4 className="font-medium text-gray-800 mb-2">{feature.name}</h4>
                                    <p className="text-sm text-gray-600">{feature.description}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                    
                    {/* Phases Accordion */}
                    <div className="space-y-6">
                        {phases.map((phase, index) => (
                            <div 
                                key={phase.id} 
                                ref={el => phaseRefs.current[phase.id] = el}
                                className="scroll-mt-6"
                            >
                                {/* Phase Header - Always Visible */}
                                <div 
                                    className={`bg-white border-2 rounded-lg transition-all cursor-pointer
                                        ${expandedPhase === phase.id ? 'border-blue-400 shadow-lg' : 'border-gray-200 hover:border-gray-300'}`}
                                    onClick={() => handlePhaseClick(phase.id)}
                                >
                                    <div className="p-6">
                                        <div className="flex items-start gap-4">
                                            <div className={`w-14 h-14 ${phase.color} rounded-full flex items-center justify-center text-white font-bold text-xl flex-shrink-0`}>
                                                {phase.id}
                                            </div>
                                            <div className="flex-1">
                                                <div className="flex items-center gap-3 mb-2">
                                                    <h3 className="text-xl font-semibold text-gray-800">{phase.name}</h3>
                                                    <code className="text-sm bg-gray-100 px-2 py-1 rounded font-mono">{phase.cli}</code>
                                                </div>
                                                <p className="text-gray-600 mb-3">{phase.description}</p>
                                                
                                                {/* Input/Output Preview */}
                                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                                                    <div className="bg-blue-50 p-3 rounded-lg">
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <FileIcon type={phase.primaryInput.file.includes('/') ? 'directory' : 'file'} />
                                                            <span className="text-sm font-medium text-blue-800">Input:</span>
                                                        </div>
                                                        <code className="text-xs block text-blue-700">{phase.primaryInput.file}</code>
                                                    </div>
                                                    
                                                    <div className="flex items-center justify-center">
                                                        <ArrowRight className="w-5 h-5 text-gray-400" />
                                                    </div>
                                                    
                                                    <div className="bg-green-50 p-3 rounded-lg">
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <FileIcon type={phase.primaryOutput.file.includes('/') ? 'directory' : 'file'} />
                                                            <span className="text-sm font-medium text-green-800">Output:</span>
                                                        </div>
                                                        <code className="text-xs block text-green-700">{phase.primaryOutput.file}</code>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="flex-shrink-0">
                                                {expandedPhase === phase.id ? (
                                                    <ChevronUp className="w-5 h-5 text-gray-400" />
                                                ) : (
                                                    <ChevronDown className="w-5 h-5 text-gray-400" />
                                                )}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Expanded Content */}
                                    {expandedPhase === phase.id && (
                                        <div className="border-t border-gray-200 bg-gray-50 p-6 space-y-6">
                                            {/* Phase Explanation */}
                                            {phase.phaseExplanation && (
                                                <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                                    <p className="text-gray-700 leading-relaxed">{phase.phaseExplanation}</p>
                                                </div>
                                            )}

                                            {/* CLI Command Example */}
                                            <div className="bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm">
                                                <span className="text-gray-400">$</span> python {phase.cli}.py {phase.primaryInput.file}
                                            </div>

                                            {/* Input/Output Specification */}
                                            <div className="bg-white border border-gray-200 rounded-lg p-6">
                                                <h3 className="font-semibold mb-4 flex items-center gap-2">
                                                    <FileText className="w-5 h-5" />
                                                    Module Interface Specification
                                                </h3>
                                                
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    {/* Input */}
                                                    <div className="bg-blue-50 p-4 rounded-lg border border-blue-200">
                                                        <h4 className="font-medium text-blue-900 mb-3 flex items-center gap-2">
                                                            <FileIcon type={phase.primaryInput.file.includes('/') ? 'directory' : 'file'} />
                                                            Primary Input
                                                        </h4>
                                                        <code className="block text-sm bg-white px-3 py-2 rounded mb-2 border border-blue-200">
                                                            {phase.primaryInput.file}
                                                        </code>
                                                        <p className="text-sm text-blue-800">{phase.primaryInput.description}</p>
                                                    </div>
                                                    
                                                    {/* Output */}
                                                    <div className="bg-green-50 p-4 rounded-lg border border-green-200">
                                                        <h4 className="font-medium text-green-900 mb-3 flex items-center gap-2">
                                                            <FileIcon type={phase.primaryOutput.file.includes('/') ? 'directory' : 'file'} />
                                                            Primary Output
                                                        </h4>
                                                        <code className="block text-sm bg-white px-3 py-2 rounded mb-2 border border-green-200">
                                                            {phase.primaryOutput.file}
                                                        </code>
                                                        <p className="text-sm text-green-800">{phase.primaryOutput.description}</p>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Data Flow */}
                                            <div className="bg-gradient-to-r from-blue-50 to-green-50 border border-gray-200 rounded-lg p-6">
                                                <h3 className="font-semibold mb-4 flex items-center gap-2">
                                                    <Zap className="w-5 h-5" />
                                                    Data Transformation Flow
                                                </h3>
                                                <div className="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div className="space-y-3">
                                                        <div className="flex items-center gap-3">
                                                            <span className="text-sm font-medium text-blue-700 w-20">Input:</span>
                                                            <span className="text-sm text-gray-700 flex-1">{phase.dataFlow.input}</span>
                                                        </div>
                                                        <div className="flex items-center gap-3">
                                                            <span className="text-sm font-medium text-purple-700 w-20">Process:</span>
                                                            <span className="text-sm text-gray-700 flex-1">{phase.dataFlow.internal}</span>
                                                        </div>
                                                        <div className="flex items-center gap-3">
                                                            <span className="text-sm font-medium text-green-700 w-20">Output:</span>
                                                            <span className="text-sm text-gray-700 flex-1">{phase.dataFlow.output}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Internal Processes */}
                                            <div className="bg-white border border-gray-200 rounded-lg p-6">
                                                <h3 className="font-semibold mb-4 flex items-center gap-2">
                                                    <Settings className="w-5 h-5" />
                                                    Internal Processes
                                                </h3>
                                                
                                                <div className="space-y-4">
                                                    {phase.subProcesses.map((subprocess, idx) => (
                                                        <div key={idx} className={`border-2 rounded-lg p-3 ${getProcessColor(subprocess.type)}`}>
                                                            <div className="flex items-start gap-3">
                                                                <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${
                                                                    subprocess.type === 'decision' ? 'bg-yellow-200 text-yellow-800' :
                                                                    subprocess.type === 'process' ? 'bg-blue-200 text-blue-800' :
                                                                    'bg-gray-200 text-gray-800'
                                                                }`}>
                                                                    {getProcessIcon(subprocess.type)}
                                                                </div>
                                                                <div className="flex-1">
                                                                    <h6 className="font-medium text-gray-800 mb-1">{subprocess.name}</h6>
                                                                    <p className="text-sm text-gray-600 mb-2">{subprocess.description}</p>
                                                                    {subprocess.transforms && (
                                                                        <div className="bg-white p-2 rounded border border-gray-200">
                                                                            <p className="text-xs text-gray-700">
                                                                                <span className="font-medium">Transform:</span> {subprocess.transforms}
                                                                            </p>
                                                                        </div>
                                                                    )}
                                                                    {subprocess.explanation && (
                                                                        <div className="mt-2 p-2 bg-gray-50 rounded">
                                                                            <p className="text-xs text-gray-600">{subprocess.explanation}</p>
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>

                                            {/* Performance Measures Catalog for Phase 1 */}
                                            {phase.id === 1 && phase.performanceCatalog && (
                                                <DetailBlock title="Performance Measures Catalog (KPI/MoE/MoP)" icon={<BarChart3 className="w-4 h-4" />} color="border-green-200">
                                                    {phase.performanceCatalog.explainer && (
                                                        <ExplainerBox>
                                                            {phase.performanceCatalog.explainer}
                                                        </ExplainerBox>
                                                    )}
                                                    {phase.performanceCatalog.typeExplainers && (
                                                        <div className="mb-4 space-y-2">
                                                            <div className="p-2 bg-blue-50 rounded border border-blue-200">
                                                                <span className="font-medium text-blue-800">KPI:</span> <span className="text-sm text-blue-700">{phase.performanceCatalog.typeExplainers.KPI}</span>
                                                            </div>
                                                            <div className="p-2 bg-green-50 rounded border border-green-200">
                                                                <span className="font-medium text-green-800">MoE:</span> <span className="text-sm text-green-700">{phase.performanceCatalog.typeExplainers.MoE}</span>
                                                            </div>
                                                            <div className="p-2 bg-purple-50 rounded border border-purple-200">
                                                                <span className="font-medium text-purple-800">MoP:</span> <span className="text-sm text-purple-700">{phase.performanceCatalog.typeExplainers.MoP}</span>
                                                            </div>
                                                        </div>
                                                    )}
                                                    <div className="overflow-x-auto">
                                                        <table className="w-full text-sm">
                                                            <thead>
                                                                <tr className="border-b border-gray-200">
                                                                    <th className="text-left py-2 px-3 font-medium">ID</th>
                                                                    <th className="text-left py-2 px-3 font-medium">Type</th>
                                                                    <th className="text-left py-2 px-3 font-medium">Name</th>
                                                                    <th className="text-left py-2 px-3 font-medium">Unit</th>
                                                                    <th className="text-left py-2 px-3 font-medium">Threshold</th>
                                                                    <th className="text-left py-2 px-3 font-medium">Description</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                {phase.performanceCatalog.data.map((metric, idx) => (
                                                                    <tr key={idx} className="border-b border-gray-100 hover:bg-gray-50">
                                                                        <td className="py-2 px-3 font-mono text-xs">{metric.id}</td>
                                                                        <td className="py-2 px-3">
                                                                            <span className={`px-2 py-0.5 rounded text-xs font-medium ${
                                                                                metric.type === 'KPI' ? 'bg-blue-100 text-blue-800' :
                                                                                metric.type === 'MoE' ? 'bg-green-100 text-green-800' :
                                                                                'bg-purple-100 text-purple-800'
                                                                            }`}>
                                                                                {metric.type}
                                                                            </span>
                                                                        </td>
                                                                        <td className="py-2 px-3 font-medium">{metric.name}</td>
                                                                        <td className="py-2 px-3 text-gray-600">{metric.unit}</td>
                                                                        <td className="py-2 px-3">{metric.threshold}</td>
                                                                        <td className="py-2 px-3 text-gray-600">{metric.description}</td>
                                                                    </tr>
                                                                ))}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </DetailBlock>
                                            )}
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Footer */}
                    <div className="mt-12 text-center py-8 border-t border-gray-200">
                        <p className="text-sm text-gray-500">
                            NATO M&S Lifecycle Automation • RFP-ACT-SACT-25-64 • Interactive Workflow Visualization
                        </p>
                        <p className="text-xs text-gray-400 mt-2">
                            This system demonstrates AI automation capabilities for NATO's Modeling & Simulation lifecycle requirements
                        </p>
                    </div>
                </div>
            );
        };

        // Render the application
        ReactDOM.render(React.createElement(InteractiveWorkflow), document.getElementById('nato-root'));
    </script>
</body>
</html>